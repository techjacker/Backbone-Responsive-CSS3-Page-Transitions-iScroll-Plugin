/*!
 * backbone.responsiveCSS3transitions.iscroll v0.1.0
 * git://github.com/techjacker/Backbone-Responsive-CSS3-Page-Transitions-iScroll-Plugin
 *
 * Demos: http://projects.andrewgriffithsonline.com/#backbone-responsive-CSS3-page-transitions
 * Documentation: https://github.com/techjacker/Backbone-Responsive-CSS3-Page-Transitions-iScroll-Plugin
 *
 * Copyright 2012, Andrew Griffiths
 * Released under a MIT license
 *
 * Date: 2012-11-16
 */
(function(e,t){"use strict";typeof define=="function"&&define.amd?define(["backbone","backboneResponsiveCSS3Transitions","iscroll"],t):e.backboneResponsiveCSS3Transitions=t(e.Backbone,e.backboneResponsiveCSS3Transitions)})(this,function(e,t){"use strict";var n=0,r=function(e){e&&(e.iScroll!==undefined&&window.iScroll!==undefined&&(_.isObject(e.iScroll)&&(this.iScrollOptions=_.isObject(e.iScroll.options)?e.iScroll.options:null,this.iScrollClass=_.isString(e.iScroll.scrollerClass)?e.iScroll.scrollerClass:!1,this.iScrollDefault=e.iScroll.activeDefault,this.positionScroller=e.iScroll.positionScroller),this.iScrollActivePrev=this.iScrollActive=this.iScrollDefault===!1?!1:!0,this.iScrollActive&&$("body").addClass("iscroll-body"),this.on("threeDTransiScroll.toggleiScroll",function(e){this.toggleiScrollActive()})),_(this).bindAll("toggleiScrollActive","positionScrollerSetUp","addScrollerPositioningCss","hideScrollbar","hideScrollbarSledgehammer","showScrollbarSledgehammer","initializeiScroll","initializeiScrollFn","addiScrollWrappers","destroyiScroll","setPagePreAnimationStyles")),t.apply(this,[e])};return _.extend(r.prototype,t.prototype,{toggleiScrollActive:function(e){e!==!1&&(this.iScrollActive=!this.iScrollActive),this.iScrollActive===!1?this.newView&&this.newView.iScroll&&($(this.newView.iScroll.vScrollbarWrapper).addClass("op-zero"),$(window).off(".threeDTransiScroll"),this.destroyiScroll(this.newView)):e!==!1&&(this.addiScrollWrappers(),this.initializeiScroll()),this.iScrollActivePrev=this.iScrollActive,$("body").toggleClass("iscroll-body")},showScrollbarSledgehammer:function(){this.newView.$el.css({overflow:"visible"}).removeClass("hideSiblings")},addScrollerPositioningCss:function(){var e=this.newView.$el.outerWidth(!0),t=this.newView.$el.children("#scroll-main").outerWidth(!0),n=e-t,r;n=n&&n/2||this.newView.el.offsetLeft,r=-n+2,this.newView&&this.newView.iScroll&&$(this.newView.iScroll.vScrollbarWrapper).css({right:r}),this.showScrollbarSledgehammer()},positionScrollerSetUp:function(){this.positionScroller?(this.addScrollerPositioningCss(),$(window).on("resize.threeDTransiScroll",_.debounce(this.hideScrollbarSledgehammer,300,!0)),$(window).on("resize.threeDTransiScroll",_.debounce(this.addScrollerPositioningCss,300))):this.showScrollbarSledgehammer()},addiScrollWrappers:function(){this.iScrollActive&&this.newView.$el.attr("id")!=="iscroll-wrapper"&&(this.newView.$el.attr("id","iscroll-wrapper"),this.newView.$el.wrapInner('<div id="scroll-main" />'))},initializeiScrollFn:function(){this.iScrollActive&&(this.hideScrollbarSledgehammer(),this.newView.iScroll=new iScroll("iscroll-wrapper",this.iScrollOptions),this.newView.iScroll.scrollTo(0,0,0),this.iScrollClass&&$(this.newView.iScroll.vScrollbarWrapper).addClass(this.iScrollClass),setTimeout(this.positionScrollerSetUp,200))},initializeiScroll:function(){this.prevView&&this.prevView.iScroll&&this.destroyiScroll(this.prevView),this.iScrollActive&&setTimeout(this.initializeiScrollFn,50)},hideScrollbar:function(){this.iScrollActive&&this.prevView&&this.prevView.iScroll&&($(this.prevView.iScroll.vScrollbarWrapper).addClass("op-zero"),this.prevView.$el.css("overflow","hidden"))},hideScrollbarSledgehammer:function(){this.newView.$el.addClass("hideSiblings")},destroyiScroll:function(e){e.iScroll&&(e.iScroll&&e.iScroll.destroy(),e.iScroll=null)},insertNewPageDefault:function(){this.addiScrollWrappers(),t.prototype.insertNewPageDefault.call(this),this.initializeiScroll()},setPagePreAnimationStyles:function(){t.prototype.setPagePreAnimationStyles.call(this),this.hideScrollbar(),this.addiScrollWrappers()},enableLinks:function(e){t.prototype.enableLinks.apply(this,[e]),this.initializeiScroll()},unbindViewRenderCallback:function(e){t.prototype.unbindViewRenderCallback.apply(this,[e]),this.destroyiScroll(e)},triggerTransition:function(e,n){n&&n.iScrollActive!==undefined&&(this.iScrollActive=n.iScrollActive,this.iScrollActivePrev!==this.iScrollActive&&this.toggleiScrollActive(!1)),t.prototype.triggerTransition.apply(this,[e,n])}}),r.extend=t.extend,r});